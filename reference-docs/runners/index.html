<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Axual">
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Runners - KSML</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../css/brands.min.css" rel="stylesheet">
        <link href="../../css/solid.min.css" rel="stylesheet">
        <link href="../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">KSML</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item">
                                <a href="../../introduction/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../../quick-start/" class="nav-link">Quick start</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Reference</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../streams/" class="dropdown-item">Streams</a>
</li>
                                    
<li>
    <a href="../pipelines/" class="dropdown-item">Pipelines</a>
</li>
                                    
<li>
    <a href="../types/" class="dropdown-item">Types</a>
</li>
                                    
<li>
    <a href="../notations/" class="dropdown-item">Notations</a>
</li>
                                    
<li>
    <a href="../operations/" class="dropdown-item">Operstions</a>
</li>
                                    
<li>
    <a href="../functions/" class="dropdown-item">Functions</a>
</li>
                                    
<li>
    <a href="../stores/" class="dropdown-item">Stores</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Runners</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <a href="../../ksml-language-spec/" class="nav-link">Language specification</a>
                            </li>
                            <li class="nav-item">
                                <a href="../../release-notes/" class="nav-link">Release Notes</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../stores/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../../ksml-language-spec/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#ksml-runner" class="nav-link">KSML Runner</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#introduction" class="nav-link">Introduction</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#configuration" class="nav-link">Configuration</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#starting-a-container" class="nav-link">Starting a container</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="ksml-runner">KSML Runner</h1>
<h3 id="table-of-contents">Table of Contents</h3>
<ol>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#configuration">Configuration</a><ul>
<li><a href="#using-with-axual-platform-or-other-namespaced-kafka-clusters">Namespace support</a></li>
</ul>
</li>
<li><a href="#starting-a-container">Starting a container</a></li>
</ol>
<h2 id="introduction">Introduction</h2>
<p>KSML is built around the <code>ksml</code> module, which provides the core functionality for parsing KSML
definition files and converting them into Kafka Streams topologies. To keep KSML lightweight and
flexible, it does not execute these topologies directly.</p>
<p>Instead, execution is handled by the <code>ksml-runner</code> module â€” a standalone Java application that
loads KSML configurations and runs the corresponding Kafka Streams applications.</p>
<p>The <code>ksml-runner</code> supports standard Kafka configurations and includes advanced features for working
with Kafka clusters that use namespacing (e.g., tenant-aware deployments).</p>
<p>Example runner configurations are provided below.</p>
<h2 id="configuration">Configuration</h2>
<p>The configuration file passed to the KSML runner is in YAML format and should contain at least the following:</p>
<pre><code class="language-yaml">ksml:
  applicationServer:                           # The application server is currently only offering REST querying of state stores
    enabled: true                              # true if you want to enable REST querying of state stores
    host: 0.0.0.0                              # by default listen on all interfaces
    port: 8080                                 # port to listen on
  configDirectory: /ksml/config                # Location of the KSML definitions. Default is the current working directory
  schemaDirectory: /ksml/schemas               # Location of the schema definitions. Default is the config directory
  storageDirectory: /ksml/data                 # Where the stateful data is written. Defaults is the default JVM temp directory
  errorHandling:                               # how to handle errors
    consume:
      log: true                                # log errors
      logPayload: true                         # log message payloads upon error
      loggerName: ConsumeError                 # logger name
      handler: continueOnFail                  # continue or stop on error
    process:
      log: true                                # log errors
      logPayload: true                         # log message payloads upon error
      loggerName: ProcessError                 # logger name
      handler: stopOnFail                      # continue or stop on error
    produce:
      log: true                                # log errors
      logPayload: true                         # log message payloads upon error
      loggerName: ProduceError                 # logger name
      handler: continueOnFail                  # continue or stop on error
    enableProducers: true                      # False to disable producers in the KSML definition
    enablePipelines: true                      # False to disable pipelines in the KSML definition
    definitions:                               # KSML definition files from the working directory
      namedDefinition1: definition1.yaml
      namedDefinition2: definition2.yaml
      namedDefinition3: &lt;more here...&gt;

kafka:                                         # Kafka streams configuration options 
  application.id: io.ksml.example.processor
  bootstrap.servers: broker-1:9092,broker-2:9092
  security.protocol: SSL
  ssl.protocol: TLSv1.3
  ssl.enabled.protocols: TLSv1.3,TLSv1.2
  ssl.endpoint.identification.algorithm: &quot;&quot;
  ssl.truststore.location: /ksml/config/truststore.jks
  ssl.truststore.password: password-for-truststore

  # Schema Registry client configuration, needed when schema registry is used
  schema.registry.url: http://schema-registry:8083
  schema.registry.ssl.truststore.location: /ksml/config/truststore.jks
  schema.registry.ssl.truststore.password: password-for-truststore
</code></pre>
<h3 id="using-with-axual-platform-or-other-namespaced-kafka-clusters">Using with Axual platform or other namespaced Kafka clusters</h3>
<p>A special mode for connecting to clusters that use namespaced Kafka resources is available. This mode
can be activated by specifying the namespace pattern to use. This pattern will be resolved to a complete
name by KSML using the provided configuration options.</p>
<p>The following config will resolve the backing topic of a stream or table</p>
<pre><code class="language-yaml">kafka:
   # The patterns for topics, groups and transactional ids.
   # Each field between the curly braces must be specified in the configuration, except the topic,
   # group.id and transactional.id fields, which is used to identify the place where the resource name
   # is used
   topic.pattern: &quot;{tenant}-{instance}-{environment}-{topic}&quot;
   group.id.pattern: &quot;{tenant}-{instance}-{environment}-{group.id}&quot;
   transactional.id.pattern: &quot;{tenant}-{instance}-{environment}-{transactional.id}&quot;

   # Additional configuration options used for resolving the pattern to values
   tenant: &quot;ksmldemo&quot;
   instance: &quot;dta&quot;
   environment: &quot;dev&quot;
</code></pre>
<h2 id="starting-a-container">Starting a container</h2>
<p>To start a container the KSML definitions and Runner configuration files need to be available in a directory mounted
inside the docker container.</p>
<p>The default Runner configuration filename is <strong><em>ksml-runner.yaml</em></strong>.
If no arguments are given, the runner will look for this file in the home directory</p>
<pre><code>## -w sets the current working directory in the container

docker run --rm -ti -v /path/to/local/ksml/directory:/ksml -w /ksml axual/ksml-axual:snapshot

## or

docker run --rm -ti -v /path/to/local/ksml/directory:/ksml -w /ksml axual/ksml-axual:snapshot /ksml/ksml-runner.yaml
</code></pre>
<p>or, if the runner configuration is in a different file, like <strong><em>my-runner.yaml</em></strong>.</p>
<pre><code>docker run --rm -ti -v /path/to/local/ksml/directory:/ksml axual/ksml-axual:latest /ksml/my-runner.yaml
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
